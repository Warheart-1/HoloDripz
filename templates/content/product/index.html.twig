{% extends 'base.html.twig' %}

{% block title %}Product index{% endblock %}

{% block body %}
 <nav class=" m-auto bg-white border-b-gray-400 border w-screen h-24 p-auto sticky">
        <section>
            <ul class=" flex flex-row content-end justify-end mr-2">
                <li class=" mt-4">
                {% if app.user %}
                    <a href=""><i class="fa-regular fa-user mr-5"></i></a>
                    <a href="{{ path('app_cart_products_show', {'id': app.user.id}) }}"><i class="fa-solid fa-cart-shopping mr-5"></i></a>
                    <a href=""><i class="fa-solid fa-magnifying-glass mr-5"></i></a>
                {% else %}
                    <a href="{{ path('app_login') }}"><i class="fa-regular fa-user mr-5"></i></a>
                    <a href="{{ path('app_login') }}"><i class="fa-solid fa-cart-shopping mr-5"></i></a>
                    <a href="{{ path('app_login') }}"><i class="fa-solid fa-magnifying-glass mr-5"></i></a>
                {% endif %}
                </li>

            </ul>
        </section>
        <section>
            <ul class=" flex flex-row justify-center mt-auto">
                <li class=" mr-5 hover:text-gray-400 duration-300 ease-in-out"><a href="{{ path('app_home') }}">Home</a></li>
                <li class=" mr-5 hover:text-gray-400 duration-300 ease-in-out"><a href="">Omocat product</a></li>
                <li class=" mr-5 hover:text-gray-400 duration-300 ease-in-out"><a href="">About</a></li>
                <li class=" mr-5 hover:text-gray-400 duration-300 ease-in-out"><a href="">Contact</a></li>
            </ul>
        </section>
    </nav>
    <section class="grid grid-cols-3 content-center">
        {% for product in products %}
        <article>
            <div class=" p-24 w-auto h-auto" data-classProduct="productRedirect" data-idProduct="{{product.id}}">
                <div class=" flex flex-col" data-idProduct="{{product.id}}">
                    <img data-idProduct="{{product.id}}" src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcS6sj18N6syLyC0Tj_fjV0f4Rw3FvbwxvBzGnDGjM6mFg-A5wtmuTyDO7V_znIXMkLhPR8&usqp=CAU" alt="">
                    <h1 class=" text-center text-gray-500 mt-2">{{ product.name }}</h1>
                    <p class=" text-center text-gray-500"> From $ {{ product.price }}</p>
                </div>
        </article>
        {% endfor %}
    </section>

    <a href="{{ path('app_create_product') }}">Create new</a>
{% endblock %}

{% block javascripts %}
    {{ parent() }}
    <script defer>
    console.log('test');
        window.addEventListener('DOMContentLoaded', (event) => {
            const productRedirect = document.querySelectorAll("[data-classProduct='productRedirect']");
            productRedirect.forEach((product) => {
                product.addEventListener('click', (event) => 
                {
                    event.preventDefault();
                    window.location.href = `/product/${event.target.dataset.idproduct}`;
                })
            })
        })
    </script>
{% endblock %}